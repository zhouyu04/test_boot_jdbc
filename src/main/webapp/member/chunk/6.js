(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"321":function(e,t,n){"use strict";function parseUrl(e){e=e||window.location.href||"";var t,n,a=/\+/g,o=/([^&=]+)=?([^&]*)/g,r=e?e.replace(/%/g,"%25"):"",c=function decode(e){return decodeURIComponent(e.replace(a," "))},i=r.indexOf("?"),s={};if(-1===i)return{};for(n=r.slice(i+1,r.length);t=o.exec(n);)s[c(t[1])]=c(t[2]);return s}function formatMoneyPoint(e,t){if(t=t||2,Number.isNaN(e))return"0";if(0===e||0===Number(e))return"0.00";if(-1===(e=e.toString()).indexOf("."))return e+"."+"".padEnd(t,"0");var n=e.split(".");return n[1].length>t?e=function roundNum(e,t){return _.round(e,t)}(Number(e),t).toString():n[0]+"."+n[1].padEnd(t,"0")}function calcAdd(e,t){var n,a,o;try{n=e.toString().split(".")[1].length}catch(e){n=0}try{a=t.toString().split(".")[1].length}catch(e){a=0}return(calcMul(e,o=Math.pow(10,Math.max(n,a)))+calcMul(t,o))/o}function calcMul(e,t){t=void 0===t?0:t;var n=0,a=(e=void 0===e?0:e).toString(),o=t.toString();try{n+=a.split(".")[1].length}catch(e){}try{n+=o.split(".")[1].length}catch(e){}return Number(a.replace(".",""))*Number(o.replace(".",""))/Math.pow(10,n)}function formatMoney(e,t){var n=2;return t&&(n=t),function _formatMoney(e){var t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")}(formatMoneyPoint(e,n))}n.d(t,"d",(function(){return parseUrl})),n.d(t,"c",(function(){return formatMoneyPoint})),n.d(t,"a",(function(){return calcAdd})),n.d(t,"b",(function(){return formatMoney}))},"331":function(e,t,n){},"342":function(e,t,n){"use strict";n.r(t);var a,o=n(23),r=n.n(o),c=n(2),i=n(38),s=n(3),u=n(4),l=n(31),d=n(12),p=n(13),m=n(6),f=n(1),b=n.n(f),h=n(320),j=n(322),g=n(321),O=(n(331),n(83)),v=n(84),I=Object(v.b)("store")(a=Object(v.c)(a=function(e){Object(d.a)(Index,e);var t=Object(p.a)(Index);function Index(e){var n;return Object(s.a)(this,Index),n=t.call(this,e),Object(m.a)(Object(l.a)(n),"saveParams",(function(e){n.props.store.couponStore.setParams(e)})),Object(m.a)(Object(l.a)(n),"saveCpInfo",(function(e){n.props.store.couponStore.setCpInfo(e)})),Object(m.a)(Object(l.a)(n),"jumpToShare",(function(){O.default.navigateTo({"url":"/coupon/share"})})),Object(m.a)(Object(l.a)(n),"init",(function(){var e=Object.assign({"userName":"","tenantId":"","accountId":"","schemaId":""},Object(g.d)());n.setState(e),n.saveParams(e)})),Object(m.a)(Object(l.a)(n),"initCouponInfo",(function(){n.state.tenantId,n.state.accountId,n.state.schemaId,["number","name","type","value","threshold","thresholdvalue","validdatestart","validdateend","suitstore_entity.store_bdname","coupontype","obtaindate","obtainafter","obtainduration","comment","storeoffline","storeoffline","rd_suittype_store"].join()})),Object(m.a)(Object(l.a)(n),"handleChange",(function(e){n.setState({"mobile":e})})),Object(m.a)(Object(l.a)(n),"receiveCoupon",Object(i.a)(r.a.mark((function _callee(){var e;return r.a.wrap((function _callee$(t){for(;;)switch(t.prev=t.next){case 0:if(!(n.state.mobile.length<11)){t.next=4;break}return t.next=3,Object(O.showToast)({"title":"请输入正确格式的手机号","icon":"none","duration":1e3});case 3:return t.abrupt("return");case 4:return n.saveParams({"mobile":n.state.mobile}),"/ierp/innernal-api/app/lsmk/coupons_distribute",e={"header":{"Content-Type":"application/json","userName":"administrator","tenantId":n.state.tenantId,"accountId":n.state.accountId},"body":{"mobile":n.state.mobile,"schemaId":n.state.schemaId,"channel":1}},n.setState({"loading":!0}),t.next=10,Object(O.request)({"url":"/ierp/innernal-api/app/lsmk/coupons_distribute","method":"POST","credentials":"include","header":Object(c.a)({"content-type":"application/json"},e.header),"data":JSON.stringify(e.body),"success":function success(e){e.data.success?(Object(O.showToast)({"title":"领取成功","duration":1e3,"icon":"none"}),n.saveCpInfo(e.data.data[0]),setTimeout((function(){n.jumpToShare()}),1e3)):Object(O.showToast)({"title":e.data.message,"duration":1e3,"icon":"none"}),console.log("success",e),n.setState({"loading":!1})},"fail":function fail(e){console.log(e),n.setState({"loading":!1})}});case 10:case"end":return t.stop()}}),_callee)})))),n.state={"mobile":"","userName":"","tenantId":"","accountId":"","schemaId":"","loading":!1},n}return Object(u.a)(Index,[{"key":"componentDidMount","value":function componentDidMount(){this.init()}},{"key":"render","value":function render(){return b.a.createElement(h.View,{"className":"receive-coupon"},b.a.createElement(h.View,{"className":"header"}),b.a.createElement(h.View,{"className":"content"},b.a.createElement(h.View,{"className":"operate"},b.a.createElement(j.AtInput,{"name":"mobile","value":this.state.mobile,"onChange":this.handleChange,"placeholder":"请输入手机号","className":"mobile"}),b.a.createElement(j.AtButton,{"type":"primary","loading":this.state.loading,"onClick":this.receiveCoupon,"className":"receive"},"领取优惠券"))))}}]),Index}(f.Component))||a)||a;t.default=I}}]);